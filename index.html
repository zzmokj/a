<ï¼doctype è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€>
<è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ æœ—="zh-CN">
<å¤´>
<å…ƒ å­—ç¬¦é›†="UTF-8">
<å…ƒåç§°=â€œè§†å£â€å†…å®¹=â€œå®½åº¦=è®¾å¤‡å®½åº¦ï¼Œåˆå§‹æ¯”ä¾‹=1.0â€>
<æ ‡é¢˜>åŸä¸œåˆä¸­è¡¨ç™½å¢™</æ ‡é¢˜>
<é“¾æ¥ rel="æ ·å¼è¡¨"href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<é£æ ¼>
*{
é¡µè¾¹è·ï¼š0ï¼›
å¡«å……ï¼š0ï¼›
æ¡†å¤§å°ï¼šè¾¹æ¡†æ¡†ï¼›
å­—ä½“ç³»åˆ—ï¼šâ€œå¾®è½¯é›…é»‘â€ï¼Œâ€œä»¿å†’SCâ€ï¼Œæ— è¡¬çº¿ï¼›
        }
æ­£æ–‡{
èƒŒæ™¯ï¼š#f5f7faï¼›
å«åº•ï¼š2remï¼›
        }
/* é¡¶éƒ¨å¯¼èˆª-å·¦ä¸Šè§’ç®¡ç†å‘˜å…¥å£ */
.å¯¼èˆªé¡¶éƒ¨{
èƒŒæ™¯ï¼š#6394F8ï¼›
é¢œè‰²ï¼š#FFFï¼›
å¡«æ–™ï¼š1rem1.2REMï¼›
ä½ç½®ï¼šç›¸å¯¹ï¼›
box-shadow:02px10px rgba(99,148,248,0.2);
font-size:1.2remï¼›
.
ä½ç½®ï¼šç»å¯¹ï¼›
ç®¡ç†å…¥å£
ä½ç½®ï¼šç»å¯¹ï¼›
é¡¶ç«¯
å…‰æ ‡ï¼šæŒ‡é’ˆï¼›
å­—ä½“å¤§å°
        }
        .nav-title {
            text-align: center;
            font-size: 1.4rem;
            font-weight: 600;
        }
        /* ç®¡ç†å‘˜é®ç½©å±‚-å¯†ç è§£é” */
        .admin-mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .admin-box {
            background: #fff;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        .admin-box h4 {
            color: #6394f8;
            margin-bottom: 1.5rem;
        }
        .admin-box input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            margin-bottom: 1rem;
            font-size: 1rem;
        }
        .admin-box button {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 6px;
            background: #6394f8;
            color: #fff;
            cursor: pointer;
            font-size: 1rem;
        }
        .admin-tip {
            color: #ff4d4f;
            margin-top: 1rem;
            font-size: 0.9rem;
            display: none;
        }
        /* é€šç”¨æ ·å¼ */
        .container {
            width: 94%;
            margin: 1rem auto;
            max-width: 800px;
        }
        .card {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 1px 8px rgba(0,0,0,0.08);
            padding: 1.2rem;
            margin-bottom: 1.2rem;
        }
        .btn {
            border: none;
            border-radius: 6px;
            padding: 0.7rem 1rem;
            cursor: pointer;
            font-size: 0.95rem;
            transition: background 0.2s;
        }
        .btn-primary {
            background: #6394f8;
            color: #fff;
        }
        .btn-primary:hover {
            background: #5285f0;
        }
        .btn-light {
            background: #f5f7fa;
            color: #333;
        }
        .btn-light:hover {
            background: #e5e7eb;
        }
        .btn-danger {
            background: #ff4d4f;
            color: #fff;
            padding: 0.5rem 0.8rem;
            font-size: 0.85rem;
        }
        .btn-danger:hover {
            background: #ff3838;
        }
        /* å…¬å‘ŠåŒº */
        .notice {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: #666;
            font-size: 0.95rem;
        }
        .notice i {
            color: #6394f8;
            font-size: 1.1rem;
        }
        /* å‘å¸ƒåŒº */
        .publish h3 {
            color: #6394f8;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .publish .form-item {
            margin-bottom: 1rem;
        }
        .publish label {
            display: block;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        .publish input, .publish textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 0.95rem;
            resize: none;
        }
        .publish textarea {
            min-height: 100px;
        }
        /* è¡¨æƒ…åŒ… */
        .emoji-wrap {
            margin-bottom: 1rem;
        }
        .emoji-btn {
            background: #f5f7fa;
            border: 1px solid #e5e7eb;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .emoji-box {
            display: none;
            flex-wrap: wrap;
            gap: 0.8rem;
            padding: 0.8rem;
            background: #f5f7fa;
            border-radius: 6px;
            margin-top: 0.8rem;
            max-height: 120px;
            overflow-y: auto;
        }
        .emoji {
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.2rem;
            border-radius: 4px;
        }
        .emoji:hover {
            background: #e5e7eb;
        }
        /* åˆ†ç±»+èƒŒæ™¯é€‰æ‹© */
        .select-wrap {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .cate-select, .bg-select {
            flex: 1;
            min-width: 150px;
        }
        .select-item {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin-top: 0.5rem;
        }
        .select-item label {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .bg-item {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .bg-item.active {
            border-color: #6394f8;
        }
        .publish .btn-group {
            display: flex;
            gap: 1rem;
        }
        .publish .btn-group button {
            flex: 1;
        }
        /* ç­›é€‰åŒº */
        .filter {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            align-items: center;
        }
        .filter-btn {
            background: #f5f7fa;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .filter-btn.active {
            background: #6394f8;
            color: #fff;
        }
        /* è¡¨ç™½åˆ—è¡¨åŒº */
        .confess-list {
            margin-top: 1rem;
        }
        .confess-card {
            position: relative;
            overflow: hidden;
            padding: 1.2rem;
            margin-bottom: 1.2rem;
        }
        .confess-card .bg-mask {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.88);
            z-index: 1;
        }
        .confess-card .card-content {
            position: relative;
            z-index: 2;
        }
        .confess-card .nickname {
            font-weight: 600;
            color: #6394f8;
            font-size: 1.05rem;
            margin-bottom: 0.5rem;
        }
        .confess-card .cate-tag {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            background: #e8f3ff;
            color: #6394f8;
            font-size: 0.8rem;
            border-radius: 10px;
            margin-bottom: 0.8rem;
        }
        .confess-card .content {
            line-height: 1.6;
            color: #333;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }
        .confess-card .info {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #999;
            margin-bottom: 1rem;
        }
        .confess-card .operate {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-bottom: 1rem;
        }
        .operate-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            color: #666;
            font-size: 0.9rem;
        }
        .operate-btn.liked {
            color: #ff4d4f;
        }
        /* è¯„è®ºåŒº */
        .comment-box {
            border-top: 1px dashed #e5e7eb;
            padding-top: 1rem;
        }
        .comment-input {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .comment-input input {
            flex: 1;
            padding: 0.7rem;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        .comment-list .comment-item {
            background: #f5f7fa;
            padding: 0.8rem;
            border-radius: 6px;
            margin-bottom: 0.8rem;
            position: relative;
        }
        .comment-item .c-nick {
            font-weight: 600;
            color: #6394f8;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
        }
        .comment-item .c-content {
            font-size: 0.9rem;
            color: #333;
            margin-bottom: 0.3rem;
        }
        .comment-item .c-time {
            font-size: 0.8rem;
            color: #999;
        }
        .comment-item .admin-del {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            display: none;
        }
        /* ç®¡ç†å‘˜æ¨¡å¼æ ·å¼ */
        .admin-mode .confess-card .admin-del-confess {
            display: block;
        }
        .admin-mode .comment-item .admin-del {
            display: block;
        }
        .empty-tip {
            text-align: center;
            color: #999;
            padding: 3rem 0;
            font-size: 0.95rem;
        }
        /* é€‚é…å°å±ç§»åŠ¨ç«¯ */
        @media (max-width: 375px) {
            .select-wrap {
                flex-direction: column;
                gap: 0.8rem;
            }
            .cate-select, .bg-select {
                min-width: 100%;
            }
            .filter {
                gap: 0.5rem;
            }
            .filter-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆª-å·¦ä¸Šè§’ç®¡ç†å‘˜å…¥å£ -->
    <div class="nav-top">
        <div class="admin-entrance" id="adminEntrance">
            <i class="fas fa-shield-halved"></i>
        </div>
        <div class="nav-title">æ ¡å›­è¡¨ç™½å¢™</div>
    </div>

    <!-- ç®¡ç†å‘˜å¯†ç è§£é”é®ç½©å±‚ -->
    <div class="admin-mask" id="adminMask">
        <div class="admin-box">
            <h4>ç®¡ç†å‘˜æƒé™è§£é”</h4>
            <input type="password" id="adminPwd" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
            <button id="adminSubmit">è§£é”</button>
            <div class="admin-tip" id="adminTip">å¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼</div>
        </div>
    </div>

    <div class="container">
        <!-- å…¬å‘ŠåŒº -->
        <div class="card notice">
            <i class="fas fa-bullhorn"></i>
            <span>æœ¬è¡¨ç™½å¢™ç”±åŸä¸œå¤§ç‰›åˆ›ä½œï¼Œä¸ºåŸä¸œä¸“å±ï¼Œæ–‡æ˜äº’åŠ¨ï¼Œç¦æ­¢å‘å¸ƒä¸è‰¯ä¿¡æ¯ï¼Œæ„Ÿè°¢é…åˆï½</span>
        </div>

        <!-- å‘å¸ƒåŒº -->
        <div class="card publish">
            <h3><i class="fas fa-pen"></i> å‘å¸ƒæˆ‘çš„è¡¨ç™½</h3>
            <div class="form-item">
                <label for="nickname">ä½ çš„æ˜µç§° <span style="color: #ff4d4f;">*</span></label>
                <input type="text" id="nickname" placeholder="è¾“å…¥ä½ çš„ä¸“å±æ˜µç§°ï¼Œä¸è¶…è¿‡20å­—" maxlength="20">
            </div>
            <div class="form-item">
                <label for="content">è¡¨ç™½å†…å®¹ <span style="color: #ff4d4f;">*</span></label>
                <textarea id="content" placeholder="å¤§èƒ†è¯´å‡ºä½ çš„å¿ƒæ„å§ï¼Œä¸è¶…è¿‡500å­—" maxlength="500"></textarea>
            </div>
            <!-- è¡¨æƒ…åŒ… -->
            <div class="emoji-wrap">
                <div class="emoji-btn" id="emojiBtn">
                    <i class="fas fa-smile"></i> é€‰æ‹©è¡¨æƒ…åŒ…
                </div>
                <div class="emoji-box" id="emojiBox">
                    ğŸ˜Š ğŸ˜ ğŸ¥° ğŸ˜˜ ğŸ’– â¤ï¸ ğŸ’› ğŸ’š ğŸ’™ ğŸ’œ âœ¨ ğŸŒŸ ğŸ‰ ğŸŠ ğŸ“ ğŸ’¬ ğŸ¤ ğŸ™ ğŸ˜š ğŸ˜œ ğŸ¤ª ğŸ˜‡ ğŸ˜Œ ğŸ˜† ğŸ˜ƒ ğŸ™ƒ ğŸ«¶ ğŸ«° ğŸ’Œ
                </div>
            </div>
            <!-- åˆ†ç±»+èƒŒæ™¯é€‰æ‹© -->
            <div class="select-wrap">
                <div class="cate-select">
                    <label>è¡¨ç™½åˆ†ç±»</label>
                    <div class="select-item">
                        <label><input type="radio" name="cate" value="æ ¡å›­æ‹çˆ±" checked> æ ¡å›­æ‹çˆ±</label>
                        <label><input type="radio" name="cate" value="å‹æƒ…ç¥ç¦"> å‹æƒ…ç¥ç¦</label>
                        <label><input type="radio" name="cate" value="æ„Ÿè°¢è¯­"> æ„Ÿè°¢è¯­</label>
                    </div>
                </div>
                <div class="bg-select">
                    <label>å¡ç‰‡èƒŒæ™¯</label>
                    <div class="select-item">
                        <div class="bg-item active" data-bg="#f5f7fa" style="background: #f5f7fa;"></div>
                        <div class="bg-item" data-bg="#fef5f7" style="background: #fef5f7;"></div>
                        <div class="bg-item" data-bg="#f5fefe" style="background: #f5fefe;"></div>
                        <div class="bg-item" data-bg="#f9f5fe" style="background: #f9f5fe;"></div>
                        <div class="bg-item" data-bg="#f7fef5" style="background: #f7fef5;"></div>
                    </div>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" id="publishBtn">å‘å¸ƒè¡¨ç™½</button>
                <button class="btn btn-light" id="clearBtn">æ¸…ç©ºå†…å®¹</button>
            </div>
        </div>

        <!-- ç­›é€‰åŒº -->
        <div class="filter">
            <button class="filter-btn active" data-cate="">å…¨éƒ¨å†…å®¹</button>
            <button class="filter-btn" data-cate="æ ¡å›­æ‹çˆ±">æ ¡å›­æ‹çˆ±</button>
            <button class="filter-btn" data-cate="å‹æƒ…ç¥ç¦">å‹æƒ…ç¥ç¦</button>
            <button class="filter-btn" data-cate="æ„Ÿè°¢è¯­">æ„Ÿè°¢è¯­</button>
        </div>

        <!-- è¡¨ç™½åˆ—è¡¨åŒº -->
        <div class="confess-list" id="confessList">
            <div class="empty-tip">æš‚æ— è¡¨ç™½å†…å®¹ï¼Œå¿«æ¥æˆä¸ºç¬¬ä¸€ä¸ªå¤§èƒ†è¡¨ç™½çš„äººå§ï½</div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let isAdmin = false; // æ˜¯å¦ä¸ºç®¡ç†å‘˜æ¨¡å¼
        const ADMIN_PWD = 'zzm'; // ç®¡ç†å‘˜å¯†ç 
        let currentBg = '#f5f7fa'; // å½“å‰é€‰ä¸­èƒŒæ™¯
        // è¡¨æƒ…åŒ…æ•°ç»„
        const EMOJIS = document.getElementById('emojiBox').innerText.split(' ');

        // DOMåŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            initEvent(); // ç»‘å®šæ‰€æœ‰äº‹ä»¶
            renderConfessList(); // æ¸²æŸ“è¡¨ç™½åˆ—è¡¨
        });

        // åˆå§‹åŒ–æ‰€æœ‰äº‹ä»¶ç»‘å®š
        function initEvent() {
            // 1. ç®¡ç†å‘˜å…¥å£-æ‰“å¼€å¯†ç æ¡†
            document.getElementById('adminEntrance').addEventListener('click', function() {
                document.getElementById('adminMask').style.display = 'flex';
                document.getElementById('adminPwd').value = '';
                document.getElementById('adminTip').style.display = 'none';
            });

            // 2. ç®¡ç†å‘˜å¯†ç éªŒè¯
            document.getElementById('adminSubmit').addEventListener('click', checkAdminPwd);
            // å¯†ç æ¡†å›è½¦éªŒè¯
            document.getElementById('adminPwd').addEventListener('keydown', function(e) {
                if (e.key === 'Enter') checkAdminPwd();
            });

            // 3. è¡¨æƒ…åŒ…æ˜¾ç¤º/éšè—
            document.getElementById('emojiBtn').addEventListener('click', function() {
                const emojiBox = document.getElementById('emojiBox');
                emojiBox.style.display = emojiBox.style.display === 'flex' ? 'none' : 'flex';
            });

            // 4. æ’å…¥è¡¨æƒ…åŒ…
            document.getElementById('emojiBox').addEventListener('click', function(e) {
                if (EMOJIS.includes(e.target.textContent)) {
                    document.getElementById('content').value += e.target.textContent;
                }
            });

            // 5. é€‰æ‹©èƒŒæ™¯
            document.querySelectorAll('.bg-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.bg-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    currentBg = this.dataset.bg;
                });
            });

            // 6. å‘å¸ƒè¡¨ç™½
            document.getElementById('publishBtn').addEventListener('click', publishConfess);

            // 7. æ¸…ç©ºå†…å®¹
            document.getElementById('clearBtn').addEventListener('click', function() {
                document.getElementById('nickname').value = '';
                document.getElementById('content').value = '';
                document.getElementById('emojiBox').style.display = 'none';
            });

            // 8. åˆ†ç±»ç­›é€‰
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    renderConfessList(this.dataset.cate);
                });
            });

            // ç‚¹å‡»é®ç½©å±‚å¤–éƒ¨å…³é—­ç®¡ç†å‘˜å¯†ç æ¡†
            document.getElementById('adminMask').addEventListener('click', function(e) {
                if (e.target === this) this.style.display = 'none';
            });
        }

        // ç®¡ç†å‘˜å¯†ç éªŒè¯
        function checkAdminPwd() {
            const pwd = document.getElementById('adminPwd').value.trim();
            const tip = document.getElementById('adminTip');
            if (pwd === ADMIN_PWD) {
                isAdmin = true;
                document.getElementById('adminMask').style.display = 'none';
                document.body.classList.add('admin-mode');
                alert('ç®¡ç†å‘˜æƒé™è§£é”æˆåŠŸï¼Œå¯åˆ é™¤ä»»æ„è¡¨ç™½/è¯„è®ºï¼');
                renderConfessList(); // é‡æ–°æ¸²æŸ“åˆ—è¡¨æ˜¾ç¤ºåˆ é™¤æŒ‰é’®
            } else {
                tip.style.display = 'block';
            }
        }

        // å‘å¸ƒè¡¨ç™½
        function publishConfess() {
            const nickname = document.getElementById('nickname').value.trim();
            const content = document.getElementById('content').value.trim();
            const cate = document.querySelector('input[name="cate"]:checked').value;

            // éªŒè¯å¿…å¡«é¡¹
            if (!nickname) {
                alert('è¯·è¾“å…¥ä½ çš„æ˜µç§°ï¼');
                return;
            }
            if (!content) {
                alert('è¯·è¾“å…¥è¡¨ç™½å†…å®¹ï¼');
                return;
            }

            // æ„é€ è¡¨ç™½æ•°æ®
            const confessData = {
                id: Date.now(), // ç”¨æ—¶é—´æˆ³ä½œä¸ºå”¯ä¸€ID
                nickname: nickname,
                content: content,
                cate: cate,
                bg: currentBg,
                like: 0,
                liked: false,
                time: formatTime(new Date()),
                comments: [] // è¯„è®ºåˆ—è¡¨
            };

            // ä»æœ¬åœ°å­˜å‚¨è·å–å·²æœ‰æ•°æ®ï¼Œæ²¡æœ‰åˆ™ä¸ºç©ºæ•°ç»„
            let confessList = JSON.parse(localStorage.getItem('confessList')) || [];
            confessList.unshift(confessData); // æ–°å¢å†…å®¹æ”¾æœ€å‰é¢
            localStorage.setItem('confessList', JSON.stringify(confessList));

            // é‡ç½®è¡¨å•
            document.getElementById('clearBtn').click();
            // é‡æ–°æ¸²æŸ“åˆ—è¡¨
            renderConfessList();
            alert('è¡¨ç™½å‘å¸ƒæˆåŠŸï¼');
        }

        // æ¸²æŸ“è¡¨ç™½åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†ç±»ç­›é€‰ï¼‰
        function renderConfessList(filterCate = '') {
            const confessList = JSON.parse(localStorage.getItem('confessList')) || [];
            const listContainer = document.getElementById('confessList');
            // ç­›é€‰æ•°æ®
            const filterData = filterCate ? confessList.filter(item => item.cate === filterCate) : confessList;

            if (filterData.length === 0) {
                listContainer.innerHTML = '<div class="empty-tip">æš‚æ— ç›¸å…³è¡¨ç™½å†…å®¹ï¼Œå¿«æ¥å‘å¸ƒå§ï½</div>';
                return;
            }

            // æ‹¼æ¥åˆ—è¡¨HTML
            let html = '';
            filterData.forEach(item => {
                // æ‹¼æ¥è¯„è®ºHTML
                let commentHtml = `
                    <div class="comment-input">
                        <input type="text" class="c-nick" placeholder="ä½ çš„æ˜µç§°" maxlength="20">
                        <input type="text" class="c-content" placeholder="è¯´ç‚¹ä»€ä¹ˆ..." maxlength="100">
                        <button class="btn btn-primary c-submit" data-id="${item.id}">å‘é€</button>
                    </div>
                    <div class="comment-list">
                        <div class="empty-tip" style="padding:1rem 0; font-size:0.85rem;">æš‚æ— è¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘ï½</div>
                    </div>
                `;
                if (item.comments && item.comments.length > 0) {
                    commentHtml = `
                        <div class="comment-input">
                            <input type="text" class="c-nick" placeholder="ä½ çš„æ˜µç§°" maxlength="20">
                            <input type="text" class="c-content" placeholder="è¯´ç‚¹ä»€ä¹ˆ..." maxlength="100">
                            <button class="btn btn-primary c-submit" data-id="${item.id}">å‘é€</button>
                        </div>
                        <div class="comment-list">
                    `;
                    item.comments.forEach(c => {
                        commentHtml += `
                            <div class="comment-item" data-cid="${c.cid}">
<div class="admin-del btn btn-danger"data-id="${é¡¹.èº«ä»½æ ‡è¯†}"data-cid="${c.CID}">åˆ é™¤</div>
<div class="c-nick">${c.å°¼å…‹}</div>
<div class="c-content">${c.å†…å®¹}</div>
<div class="C-Time">${c.æ—¶é—´}</div>
</div>
`;
                    });
                    commentHtml+='</div>';
                }

                //è¡¨ç™½å¡ç‰‡HTML
                è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€+=`
<div class="å¡ç‰‡è¡¨ç™½-å¡ç‰‡"data-id="${é¡¹.èº«ä»½æ ‡è¯†}"style="èƒŒæ™¯ï¼š${é¡¹.BG};">
<div class="bg-mask"></div>
<div class="å¡å†…å®¹">
<div class="nickname">${é¡¹.æ˜µç§°}</div>
<div class="cat-tag">${é¡¹.å‡¯ç‰¹}</div>
<div class="content">${é¡¹.å†…å®¹}</div>
<div class="info">
<span>å‘å¸ƒäº${é¡¹.æ—¶é—´}</span>
<span>è¯„è®º(${é¡¹.è¯„è®º ? é¡¹.è¯„è®º.é•¿åº¦ : 0})</span>
</div>
<div class="operate">
<button class="operate-btn like-btn${é¡¹.å–œæ¬¢ ? 'å–œæ¬¢' : ''}"data-id="${é¡¹.èº«ä»½æ ‡è¯†}">
<i class="fas fa-heart"></i>ç‚¹èµ(${é¡¹.å–œæ¬¢})
</button>
<button class="operate-btn comment-btn"data-id="${é¡¹.èº«ä»½æ ‡è¯†}">
<i class="fas fa-comment"></i>æŸ¥çœ‹è¯„è®º
</button>
<button class="admin-del-confess btn btn-danger"style="display:noneï¼›"data-id="${é¡¹.èº«ä»½æ ‡è¯†}">
åˆ é™¤æœ¬æ¡è¡¨ç™½
</button>
</div>
<div class="comment-box"id="commentbox_${é¡¹.èº«ä»½æ ‡è¯†}"style="displayï¼šæ— ï¼›">
                                ${commentHtml}
</div>
</div>
</div>
`;
            });

            listContainer.innerHTML=è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€;
            // ç»‘å®šåˆ—è¡¨ç›¸å…³äº‹ä»¶ï¼ˆç‚¹èµã€è¯„è®ºã€åˆ é™¤ï¼‰
            bindListEvent();
            // ç®¡ç†å‘˜æ¨¡å¼ä¸‹æ˜¾ç¤ºåˆ é™¤æŒ‰é’®
            å¦‚æœ (isAdmin) {
                æ–‡ä»¶.èº«ä½“.classList.æ·»åŠ ('ç®¡ç†æ¨¡å¼');
            }
        }

        // ç»‘å®šè¡¨ç™½åˆ—è¡¨çš„äº‹ä»¶ï¼ˆç‚¹èµã€è¯„è®ºã€å‘é€è¯„è®ºã€ç®¡ç†å‘˜åˆ é™¤ï¼‰
        åŠŸèƒ½ bindListEvent() {
            // 1. ç‚¹èµåŠŸèƒ½
            æ–‡ä»¶.querySelectorAll('.like-btn').foreach(BTN=>{
                BTN.addEventListener('å•å‡»', åŠŸèƒ½() {
                    Const èº«ä»½æ ‡è¯†=è¿™.æ•°æ®é›†.èº«ä»½æ ‡è¯†;
                    å¦‚æœ (è¿™.classList.åŒ…å«('å–œæ¬¢')) è¿”å›; // å·²ç‚¹èµåˆ™ä¸é‡å¤ç‚¹èµ
                    è®© confidenceList=JSON.è§£æ(localStorage.getitem('ConfessList'))||[];
                    confidenceList=confidenceList.åœ°å›¾(é¡¹=>{
                        å¦‚æœ (é¡¹.èº«ä»½æ ‡è¯†==èº«ä»½æ ‡è¯†) {
                            é¡¹.å–œæ¬¢++;
                            é¡¹.å–œæ¬¢=æ­£ç¡®;
                        }
                        è¿”å› é¡¹;
                    });
                    localStorage.setitem('ConfessList', JSON.ä½¿å­—ç¬¦ä¸²åŒ–(confidenceList));
                    è¿™.classList.æ·»åŠ ('å–œæ¬¢');
                    è¿™.innerHTML=<i class="fas fa-heart"></i>ç‚¹èµ(${parseInt(è¿™.å†…éƒ¨æ–‡æœ¬.åŒ¹é…(//\d+/)[0])+1})`;
                });
            });

            // 2. å±•å¼€/æ”¶èµ·è¯„è®º
            æ–‡ä»¶.querySelectorAll('.Comment-btn').foreach(BTN=>{
                BTN.addEventListener('å•å‡»', åŠŸèƒ½() {
                    Const èº«ä»½æ ‡è¯†=è¿™.æ•°æ®é›†.èº«ä»½æ ‡è¯†;
                    Const commentbox=æ–‡ä»¶.getElementById('CommentBox_${èº«ä»½æ ‡è¯†}`);
                    commentbox.é£æ ¼.æ˜¾ç¤º=commentbox.é£æ ¼.æ˜¾ç¤º==='å—' ? 'æ— ' : 'å—';
                });
            });

            // 3. å‘é€è¯„è®º
            document.querySelectorAll('.c-submit').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.dataset.id;
                    const cNick = this.previousElementSibling.previousElementSibling.value.trim();
                    const cContent = this.previousElementSibling.value.trim();
                    if (!cNick || !cContent) {
                        alert('è¯·è¾“å…¥æ˜µç§°å’Œè¯„è®ºå†…å®¹ï¼');
                        return;
                    }
                    // æ„é€ è¯„è®ºæ•°æ®
                    const commentData = {
                        cid: Date.now(), // è¯„è®ºå”¯ä¸€ID
                        nick: cNick,
                        content: cContent,
                        time: formatTime(new Date())
                    };
                    let confessList = JSON.parse(localStorage.getItem('confessList')) || [];
                    confessList = confessList.map(item => {
                        if (item.id == id) {
                            if (!item.comments) item.comments = [];
                            item.comments.unshift(commentData);
                        }
                        return item;
                    });
()ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–ï¼ŒJSON.confortList)ï¼›)ï¼›(currentCate)ï¼›.setItem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–ï¼ŒJSON.confortList)ï¼›)ï¼›(currentCate)ï¼›.setItem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)ï¼›(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList)ï¼›)renderConfessListlocalStoragecurrentCate(currentCate)ï¼›.setitem('confortList'ï¼ŒJSONã€‚ä½¿å­—ç¬¦ä¸²åŒ–(confortList))ï¼›
// é‡æ–°æ¸²æŸ“åˆ—è¡¨
ã€‚é£æ ¼ã€‚æ˜¾ç¤º
currentCate
currentCate
å¸¸æ•°åˆ†é’Ÿ
</è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€>/è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€>/è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€>/è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€>
            

// 4. ç®¡ç†å‘˜åˆ é™¤è¡¨ç™½
'.admin-del-confess'
'å—'
å—
è¿”å›ï¼›
/
è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€
'.admin-del-confess'
BTN
è¿™
                });
            });

// 5. ç®¡ç†å‘˜åˆ é™¤å•æ¡è¯„è®º
'.admin-del'
BTN.addEventListener('å•å‡»'ï¼Œå‡½æ•°(){.addEventListener('å•å‡»'ï¼Œå‡½æ•°(){renderConfessList('ç‚¹å‡»'ï¼Œå‡½æ•°(){.addEventListener('å•å‡»'ï¼Œå‡½æ•°(){.addEventListener('ç‚¹å‡»'ï¼Œå‡½æ•°(){renderConfessList('å¦‚æœ(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›'ï¼Œå‡½æ•°(){.addEventListener('å•å‡»'ï¼Œå‡½æ•°(){.addEventListener('å•å‡»'ï¼Œå‡½æ•°(){renderConfessList('ç‚¹å‡»'ï¼Œå‡½æ•°(){.addEventListener('å•å‡»'ï¼Œå‡½æ•°(){.addEventListener('ç‚¹å‡»'ï¼Œå‡½æ•°(){renderConfessList('å¦‚æœ(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›(ï¼ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤ï¼'))è¿”å›ï¼›'ï¼Œå‡½æ•°(){
å¦‚æœ(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›(ï¼ ç¡®è®¤('ç¡®å®šè¦åˆ é™¤æœ¬æ¡è¯„è®ºå—ï¼Ÿ åˆ é™¤åä¸å¯æ¢å¤ï¼ '))è¿”å›ï¼›
è¿”å›ï¼›
è¿™ä¸ª.æ•°æ®é›†ã€‚ èº«ä»½æ ‡è¯†ï¼›.æ•°æ®é›†ã€‚ èº«ä»½æ ‡è¯†ï¼›
CIDï¼›
confidenceList
å¦‚æœ(é¡¹.èº«ä»½æ ‡è¯†==èº«ä»½æ ‡è¯†){(é¡¹.èº«ä»½æ ‡è¯†==èº«ä»½æ ‡è¯†){(é¡¹.èº«ä»½æ ‡è¯†==èº«ä»½æ ‡è¯†){(é¡¹.èº«ä»½æ ‡è¯†==èº«ä»½æ ‡è¯†){
é¡¹ã€‚å¤‡æ³¨=é¡¹ç›®ã€‚è¯„è®ºã€‚æ»¤æ³¢å™¨(c=>c.CIDï¼=CID)ï¼›=é¡¹ç›®ã€‚è¯„è®ºã€‚æ»¤æ³¢å™¨(c=>c.CIDï¼=CID)ï¼›=é¡¹ç›®ã€‚è¯„è®ºã€‚æ»¤æ³¢å™¨(c=>c.CIDï¼=CID)ï¼›=é¡¹ç›®ã€‚è¯„è®ºã€‚æ»¤æ³¢å™¨(c=>c.CIDï¼=CID)ï¼›
                        
é€€è´§é¡¹ï¼›
                    
localStorage
Const
renderConfessList(currentCate)ï¼›(currentCate)ï¼›(currentCate)ï¼›(currentCate)ï¼›
                
            
        

//æ ¼å¼åŒ–æ—¶é—´ï¼šYYYY-MM-DD HH:MM
å‡½æ•°æ ¼å¼æ—¶é—´(æ—¥æœŸ){(æ—¥æœŸ){(æ—¥æœŸ){(æ—¥æœŸ){
Constå¹´=æ—¥æœŸ.getFullYear()ï¼›å¹´=æ—¥æœŸ.getFullYear()ï¼›=æ—¥æœŸ.getFullYear()ï¼›å¹´=æ—¥æœŸ.getFullYear()ï¼›
Const
æ’å®šå¤©æ•°=å­—ç¬¦ä¸²(æ—¥æœŸã€‚GETDATE())ã€‚padStart(2ï¼Œ"0")ï¼›å¤©=å­—ç¬¦ä¸²(æ—¥æœŸ.GETDATE()).padStart(2ï¼Œ"0")ï¼›=å­—ç¬¦ä¸²(æ—¥æœŸ.GETDATE())ã€‚padStart(2ï¼Œ"0")ï¼›å¤©=å­—ç¬¦ä¸²(æ—¥æœŸ.GETDATE()).padStart(2ï¼Œ"0")ï¼›
å¸¸æ•°å°æ—¶=å­—ç¬¦ä¸²(æ—¥æœŸ.getHours())ã€‚padStart(2ï¼Œ"0")ï¼›å°æ—¶=å­—ç¬¦ä¸²(æ—¥æœŸ.getHours()).padStart(2ï¼Œ"0")ï¼›=å­—ç¬¦ä¸²(æ—¥æœŸ.getHours())ã€‚padStart(2ï¼Œ"0")ï¼›å°æ—¶=å­—ç¬¦ä¸²(æ—¥æœŸ.getHours()).padStart(2ï¼Œ"0")ï¼›
å¸¸æ•°åˆ†é’Ÿ=å­—ç¬¦ä¸²(æ—¥æœŸ.getMinutes()).padStart(2ï¼Œ'0')ï¼›=å­—ç¬¦ä¸²(æ—¥æœŸ.getMinutes()).padStart(2ï¼Œ'0')ï¼›=å­—ç¬¦ä¸²(æ—¥æœŸ.getMinutes()).padStart(2ï¼Œ'0')ï¼›=å­—ç¬¦ä¸²(æ—¥æœŸ.getMinutes()).padStart(2ï¼Œ"0")ï¼›
å¹´
        
<
<
<
